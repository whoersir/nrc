# CloudRun 部署状态

## 📊 当前状态

**服务名称**: nrc-web
**服务类型**: 容器型（Container）
**服务状态**: ✅ 已创建，正常运行
**版本状态**: ⏳ 构建中（约需 3-5 分钟）
**最后更新**: 2026-02-03 10:57:14

---

## 🔧 配置信息

| 配置项 | 值 |
|--------|-----|
| **CPU** | 0.5 核 |
| **内存** | 1 GB |
| **端口** | 3000 |
| **最小实例数** | 1 |
| **最大实例数** | 2 |
| **访问类型** | 公网访问 (PUBLIC) |
| **自动扩缩容** | CPU/内存使用率 60% 触发 |

---

## 🌐 访问地址

### 主要访问地址

```
https://nrc-web-223371-6-1392812070.sh.run.tcloudbase.com
```

**⚠️ 重要提示**：
- 首次访问可能需要等待 10-20 秒让服务完全启动
- 如果显示 "Service version not found"，说明版本仍在构建中
- 请等待 3-5 分钟后再试

---

## 📋 已配置的环境变量

| 变量名 | 状态 |
|--------|------|
| `NEXT_PUBLIC_SUPABASE_URL` | ✅ 已配置 |
| `NEXT_PUBLIC_SUPABASE_ANON_KEY` | ✅ 已配置 |
| `NEXT_PUBLIC_APP_URL` | ✅ 已配置 |
| `NODE_ENV` | `production` |
| `PORT` | `3000` |

> ⚠️ **安全提醒**: 敏感的环境变量值已保存在 CloudBase 控制台，请勿在代码或文档中硬编码。

---

## 🔗 重要链接

| 功能 | 链接 |
|------|------|
| **🌐 访问应用** | https://nrc-web-223371-6-1392812070.sh.run.tcloudbase.com |
| **📊 服务详情** | https://tcb.cloud.tencent.com/dev?envId=nrc-8ggxdu3m3534afc0#/platform-run?serverName=nrc-web |
| **📈 日志监控** | https://tcb.cloud.tencent.com/dev?envId=nrc-8ggxdu3m3534afc0#/devops/log |

---

## ⏳ 当前问题：Service version not found

**原因**：
服务已创建成功，但版本仍在构建中。CloudRun 需要以下时间：
1. Docker 镜像构建（约 2-3 分钟）
2. 镜像上传（约 1 分钟）
3. 容器启动和初始化（约 1 分钟）

**总预计时间**: 3-5 分钟

---

## 📌 下一步操作

### 方案 1：等待并测试（推荐）

1. **等待 3-5 分钟**
2. **访问应用地址**：
   ```
   https://nrc-web-223371-6-1392812070.sh.run.tcloudbase.com
   ```
3. **如果仍显示错误**：
   - 访问控制台查看构建日志
   - 检查是否有构建错误

### 方案 2：查看控制台日志

1. **访问服务详情页**：
   ```
   https://tcb.cloud.tencent.com/dev?envId=nrc-8ggxdu3m3534afc0#/platform-run?serverName=nrc-web
   ```

2. **查看日志**：
   - 点击"日志"标签
   - 查看实时构建日志
   - 检查是否有错误信息

3. **常见问题排查**：
   - 如果看到 "build failed"，检查 Dockerfile 语法
   - 如果看到 "timeout"，可能需要增加构建时间限制
   - 如果看到 "error"，查看具体错误信息

---

## 🧪 功能测试清单

版本构建完成后，请测试以下功能：

### 基础功能
- [ ] 首页正常加载
- [ ] 页面响应速度正常
- [ ] 样式渲染正确
- [ ] 无控制台错误

### 音乐播放器
- [ ] 音乐列表显示
- [ ] 播放音乐
- [ ] 暂停/继续
- [ ] 切换歌曲（上一首/下一首）
- [ ] 播放进度拖动
- [ ] 音量控制
- [ ] 添加/取消收藏

### AI 聊天
- [ ] 聊天界面加载
- [ ] 发送消息
- [ ] 接收流式响应
- [ ] 对话历史显示
- [ ] 清除对话

### 用户认证
- [ ] 注册账号
- [ ] 登录系统
- [ ] 登出
- [ ] 个人资料页面

### 游戏功能
- [ ] 游戏列表显示
- [ ] 进入游戏
- [ ] 游戏交互

---

## 💡 故障排查

### 问题 1：Service version not found

**原因**：版本还在构建中

**解决方案**：
- 等待 3-5 分钟后重试
- 访问控制台查看构建日志
- 检查是否有构建错误

### 问题 2：502 Bad Gateway

**原因**：容器启动失败或崩溃

**解决方案**：
- 查看服务日志
- 检查环境变量配置
- 确认端口配置正确（3000）

### 问题 3：页面加载缓慢

**原因**：冷启动或网络延迟

**解决方案**：
- 首次访问需要 10-20 秒（冷启动）
- 确保最小实例数设置为 1
- 考虑升级配置（CPU/内存）

---

## 🔧 重新部署

如果需要重新部署（代码更新后），使用以下命令：

```bash
# 使用 CloudBase CLI（推荐）
cloudbase deploy

# 或者通过控制台
# 访问服务详情页 -> 点击"部署"按钮
```

---

## 📞 技术支持

如遇问题，可以：

1. **查看日志**
   - 服务详情页 -> 日志标签

2. **查看文档**
   - CloudRun 开发文档：https://docs.cloudbase.net/
   - 错误码查询：https://docs.cloudbase.net/error-code

3. **联系支持**
   - 腾讯云工单系统：https://console.cloud.tencent.com/workorder
   - 社区论坛：https://cloud.tencent.com/developer

---

## ✅ 部署检查清单

- [x] 服务创建成功
- [x] 配置参数正确
- [x] 环境变量已设置
- [x] 公网访问已开通
- [ ] 版本构建完成（进行中）
- [ ] 应用正常访问（待测试）
- [ ] 所有功能正常（待测试）

---

**📝 更新时间**: 2026-02-03 10:57:14

**🎯 下一步**: 等待 3-5 分钟，然后访问应用进行测试
